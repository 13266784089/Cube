function RSAKeyPair(e,t,n){this.radix=16,this.e=bi.newInstance(e,this.radix),this.d=bi.newInstance(t,this.radix),this.m=bi.newInstance(n,16),this.hex=bi.newInstance(this.m,this.radix),this.chunkSize=2*bi.highIndex(this.m)}function encryptedString(e,t){for(var n=new Array,r=t.length,c=0;r>c;c++)n[c]=t.charCodeAt(c);for(;n.length%e.chunkSize!=0;)n[c++]=0;var a,i,o,s=n.length,d="";for(c=0;s>c;c+=e.chunkSize){for(o=bi.newInstance(),a=0,i=c;i<c+e.chunkSize;++a)o.digits[a]=n[i++],o.digits[a]+=n[i++]<<8;var h=e.hex.powMod(o,e.e),f=h.toString(16==e.radix?"hex":"");d+=f+" "}return d.substring(0,d.length-1)}function aesEncrypt(e,t){var n=crypto.createCipheriv("AES-128-CBC",t,"0102030405060708");return n.update(e,"utf-8","base64")+n["final"]("base64")}function rsaEncrypt(e,t,n){var r=new RSAKeyPair(t,"",n),c=encryptedString(r,e);return c}function createSecretKey(e){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",r=0;e>r;r++){var c=Math.random()*t.length;c=Math.floor(c),n+=t.charAt(c)}return n}var crypto=require("crypto"),bi=require("./BigInt"),Crypto=function(){var e="00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7",t="0CoJUm6Qyw8W8jud",n="010001",r={};return r.MD5=function(e){return crypto.createHash("md5").update(e).digest("hex")},r.aesRsaEncrypt=function(r,c,a,i){a=a||e,i=i||t,c=c||n;var o={},s=createSecretKey(16);return o.encText=aesEncrypt(r,i),console.log("encText1",o.encText),o.encText=aesEncrypt(o.encText,s),console.log("encText2",o.encText),o.encSecKey=rsaEncrypt(s,c,a),console.log("encSecKey",o.encSecKey),o},r}();module.exports=Crypto;